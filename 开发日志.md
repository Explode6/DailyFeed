## 4.21

学习使用**网络技术**，从订阅源网址下载xml

​	使用的主要技术：**OkHttp**

进展：成功使用OkHttp从订阅网址下载到了xml文件



##4.22

学习安桌数据持久化技术

​	使用的主要技术有：SharedPreference（键值对），SQLite

​	需求：

​		1.解析的HTML直接存放到==SQLite==数据库   

​		2.需要用到的数据信息：频道（标题，图片，推送日期，简介），文章（标题，原文链接，作者，==时间==，类别，简介，==内容==，本地评论）

​		3.文章按日保存，需要==去重==，以最新发布的为准(增量更新)

​		4.收藏的文章另建新表

## 4.23

学习使用开源库LitePal对数据进行CRDU（ORM映射）

设计数据库:

Channel:  (

**int id[p_key]**,  

String title, 

**``String rssLink[unique, index]``**, 

String addressLink,

long lastBuildDate, 

String description, 

Image image[nullable=true] 

)



ArticleBrief:  ( 

**int id[p_key]**, 

String title, 

**``String link[unique, index]``**, 

String creator, 

**long pubDate**, 

String[] Category, 

String description, 

Boolean isRead,

**int channel_id[f_key]**

**int content_id[f_key]**

)



ArticleContent:{

**int id[p_key]**, 

String content;

}



Collection(

**int id[p_key]**, 

String title, 

**``String link[unique]``**, 

String creator, 

String[] Category, 

String description, 

String content

)



## 4.24

工作进展：创建了数据库，并完成了数据增删查改基本接口的封装，对数据库的表格进行部分优化。

逻辑结构：频道表，文章简介表，文章内容表，收藏文章表



## 4.25

工作进展：学习了WebView控件的使用，可用于文章展示。

技术要点： 

1. 展示本地的String类型html文本。
2. 处理展示的文本的样式 。
   3. 如何获知并处理用户的进一步操作。
   4. 挑战任务：如何获取用户选中的文本段，并向其中==即时添加==样式（下划虚线，点击控件）。如何获取评论，保存评论，展示评论。【⭐⭐⭐⭐⭐】

解决方案：

1. 向html中插入HTML头以及解析标签<html>, <body>, 通过WebView中的loadDataWithBaseURL(null, ``content``, “text/html”, “utf-8”, null )可展示。（已尝试）

2. 直接在WebView中展示原生HTML样式。

### 会议

1. RSS更新（定时更新/下拉刷新）：比较RSS的推送时间
2. 将ArticleBrife的pubDate对外封闭，用于排序。
3.  Article的查询应按照id的降序，插入时间的升序。
4.  数据库类的对象应有默认值。



## 4.26

数据库更新：addChannel方法用更新的方式，对4.25会议提出的议题更新了新的数据成员和对外接口。

工作进展：学习WebView与JS代码之间的互动。

####会议

WebView，拦截资源加载本地缓存图片

了解并使用==MVP架构==  

跨进程通信，通过Service在进程间传递数据，传输大数据

   

## 4.27

- MVP架构

  - Model（模型层）、View（视图层）、Presenter（主持者）

  - Contact（契约、待实现的功能）、View（管理UI，提供UI的变动接口，接收并提交用户事件）、Model（数据实体，管理数据，提供数据的存取接口，提供回调的接口）、Presenter（处理事件，调用数据，变更UI）。

  - 不直接持有类对象而持有接口对象，凡是实现了 Presenter接口 便是 Presenter 层，凡是实现了 View接口 便是 View 层。
  - Presenter层对Model层的实现类持有直接对象。

- 文章显示包的设计 showarticle
  - ShowArticleActivity：统筹视图和管理者
  - ShowArticleContract：接口定义
  - ShowArticleFragment：View层
  - ShowArticlePresenter：Presenter层
  - ShowArticleRes：实现功能用到的资源类和数据集合

## 4.28

- 设计ShowArticleWebView类，应实现接口WebView
  - WebView中包括
    - 初始化配置
    - 展示文章内容
    - 获取选中内容
    - 更改文字大小
    - 更改文字间距
    - 更改文字颜色
    - 内容分享

## 4.30

- 数据库返工
  - Channel中的image不能使用byte[]，原因是LitePal未对数组类型的进行处理，解决方案：将byte[]转String存储。传入byte[]参数，转为String类型存储，取出时转为byte[]提交。
  - ArticleBrief和Collection中的category不能使用String[]，原因同上，解决方案：将String[]组合成String存储。传入String[]参数，以“,”作为分隔符组合成String，取出时按分隔符分割成String[]提交。